<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>KF Pizzaria & Tapiocaria</title>

<style>
/* ================= RESET E BODY ================= */
body {
  font-family: Arial,sans-serif;
  background:#0e0e0e;
  color:#fff;
  margin:0;
  padding-bottom:250px;
}

/* ================= HEADER ================= */
header {
  background:#000;
  color:#fff;
  text-align:center;
  padding:20px;
}
header img {
  max-width:360px;
  width:100%;
  height:auto;
  display:block;
  margin:0 auto;
}
header span {
  font-size:22px;
  font-weight:bold;
  color:#00ff66;
}
@media (max-width:600px){
  header img { max-width:300px; }
}

/* ================= NAVEGA√á√ÉO ================= */
nav {
  display:flex;
  justify-content:space-around;
  background:#111;
  padding:10px;
}
nav button {
  flex:1;
  margin:5px;
  padding:10px;
  font-size:16px;
  background:#111;
  color:#00ff66;
  border:2px solid #00ff66;
  border-radius:8px;
  cursor:pointer;
  transition:all 0.2s ease;
}
nav button:hover { transform:scale(1.05); background:#00ff66; color:#000; }

/* ================= SECTIONS ================= */
section { display:none; padding:15px; }
section.ativo { display:block; }

/* ================= PRODUTOS ================= */
.produto, .produto-bebida {
  background:#1c1c1c;
  padding:12px;
  border-radius:10px;
  margin-bottom:10px;
  display:flex;
  justify-content:space-between;
  align-items:center;
}
.produto button, .produto-bebida button {
  background:#111;
  border:2px solid #00ff66;
  border-radius:50px;
  padding:8px 15px;
  cursor:pointer;
  font-weight:bold;
  color:#00ff66;
}
.produto button.selected {
  background:#00ff66;
  color:#000;
}

/* ================= BOT√ÉO CARRINHO ================= */
#botaoAdicionarCarrinho { 
  position: fixed; 
  bottom: 20px;
  right: 20px;
  background: #ff6600; 
  color: #fff; 
  font-weight: bold; 
  padding: 10px 18px;
  border-radius: 8px; 
  cursor: pointer; 
  z-index: 9999; 
}

/* ================= CARRINHO ================= */
#carrinho {
  background:#111;
  padding:15px;
  position:fixed;
  bottom:0;
  width:100%;
  max-height:300px;
  overflow-y:auto;
  border-top:2px solid #00ff66;
}

/* ================= INPUTS ================= */
input, select, textarea {
  width:100%;
  padding:8px;
  margin:6px 0;
  border-radius:6px;
  border:none;
}
.finalizar {
  background:#00ff66;
  padding:10px;
  width:100%;
  font-size:18px;
  border-radius:8px;
  border:none;
  cursor:pointer;
  font-weight:bold;
}
</style>
</head>

<body>

<header>
  <img src="logo-kf.png"
       onerror="this.style.display='none';document.getElementById('fallback-text').style.display='block'">
  <span id="fallback-text" style="display:none;">KF Pizzaria & Tapiocaria üçïüåÆ</span>
</header>

<nav>
  <button onclick="mostrarMenu('pizzas')">üçï Pizzas</button>
  <button onclick="mostrarMenu('tapiocas')">üåÆ Tapiocas</button>
  <button onclick="mostrarMenu('bebidas')">ü•§ Bebidas</button>
</nav>

<section id="pizzas" class="ativo">
  <div class="tamanho-pizza">
    <button onclick="selecionarTamanho('25cm')">25cm</button>
    <button onclick="selecionarTamanho('35cm')">35cm</button>
  </div>
  <div id="listaPizzas"></div>
</section>

<section id="tapiocas">
  <h3>Tapiocas (Escolha at√© 2 recheios pagos + 1 acompanhamento)</h3>
  <div id="listaTapiocas"></div>
</section>

<section id="bebidas">
  <h3>Bebidas</h3>
  <div id="listaBebidas"></div>
</section>

<button id="botaoAdicionarCarrinho"
onclick="adicionarPizzaAoCarrinho(); adicionarTapiocaAoCarrinho();">
üõí Adicionar ao Carrinho
</button>

<div id="carrinho">
  <h3>üõí Carrinho</h3>
  <div id="itensCarrinho"></div>
  <strong>Total: R$ <span id="totalCarrinho">0.00</span></strong>

  <h4>Finalizar Pedido</h4>
  <input id="nome" placeholder="Nome do cliente">
  <input id="endereco" placeholder="Endere√ßo completo">
  <select id="pagamento">
    <option value="">Forma de pagamento</option>
    <option value="dinheiro">Dinheiro</option>
    <option value="cartao">Cart√£o</option>
    <option value="pix">Pix</option>
  </select>
  <textarea id="observacao" placeholder="Observa√ß√µes"></textarea>
  <button class="finalizar" onclick="finalizarPedido()">üì≤ Enviar Pedido</button>
</div>

<!-- üî• SCRIPT COM FIREBASE CORRETO -->
<script type="module">
import { db } from "./firebase.js";
import { collection, addDoc, serverTimestamp }
from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

/* ======= TODO O SEU JS ORIGINAL FOI MANTIDO ======= */
/* ======= APENAS FINALIZAR PEDIDO FOI AJUSTADO ======= */

async function finalizarPedido(){
  const nome=document.getElementById("nome").value.trim();
  const endereco=document.getElementById("endereco").value.trim();
  const pagamento=document.getElementById("pagamento").value;
  const observacao=document.getElementById("observacao").value.trim();

  if(!nome||!endereco||!pagamento||carrinho.length===0){
    alert("Preencha todos os dados");
    return;
  }

  await addDoc(collection(db,"pedidos"),{
    nome,
    endereco,
    pagamento,
    observacao,
    itens:[...carrinho],
    total,
    criadoEm: serverTimestamp()
  });

  const msg = `üçï *NOVO PEDIDO*%0Aüë§ ${nome}%0Aüìç ${endereco}%0Aüí∞ Total: R$ ${total.toFixed(2)}`;
  window.open(`https://wa.me/5521997437285?text=${msg}`,"_blank");

  carrinho=[];
  atualizarCarrinho();
  alert("Pedido enviado com sucesso!");
}
</script>

</body>
</html>
