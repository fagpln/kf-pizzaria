<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>KF Pizzaria & Tapiocaria</title>

<style>
/* ================= RESET E BODY ================= */
body {
  font-family: Arial,sans-serif;
  background:#0e0e0e;
  color:#fff;
  margin:0;
  padding-bottom:250px;
}

/* ================= HEADER ================= */
header {
  background:#000;
  color:#fff;
  text-align:center;
  padding:20px;
}
header img {
  max-width:360px;
  width:100%;
  height:auto;
  display:block;
  margin:0 auto;
}
header span {
  font-size:22px;
  font-weight:bold;
  color:#00ff66;
}
@media (max-width:600px){
  header img { max-width:300px; }
}

/* ================= NAVEGA√á√ÉO ================= */
nav {
  display:flex;
  justify-content:space-around;
  background:#111;
  padding:10px;
}
nav button {
  flex:1;
  margin:5px;
  padding:10px;
  font-size:16px;
  background:#111;
  color:#00ff66;
  border:2px solid #00ff66;
  border-radius:8px;
  cursor:pointer;
  transition:all 0.2s ease;
}
nav button:hover { transform:scale(1.05); background:#00ff66; color:#000; }
nav button:active { transform:scale(0.95); }

/* ================= SECTIONS ================= */
section { display:none; padding:15px; }
section.ativo { display:block; }

/* ================= PRODUTOS ================= */
.produto, .produto-bebida {
  background:#1c1c1c;
  padding:12px;
  border-radius:10px;
  margin-bottom:10px;
  display:flex;
  justify-content:space-between;
  align-items:center;
}
.produto button, .produto-bebida button {
  background:#111;
  border:2px solid #00ff66;
  border-radius:50px;
  padding:8px 15px;
  cursor:pointer;
  font-weight:bold;
  color:#00ff66;
  transition:all 0.3s ease;
}
.produto button:hover, .produto-bebida button:hover {
  transform:scale(1.05);
  background:#00ff66;
  color:#000;
}
.produto button.selected, .produto-bebida button.selected {
  background:#007bff;
  color:#fff;
  box-shadow:0 0 10px #00ff66;
  animation:pulse 0.5s ease;
}
@keyframes pulse {
  0%{transform:scale(1);}
  50%{transform:scale(1.1);}
  100%{transform:scale(1);}
}

/* ================= BOT√ÉO CARRINHO ================= */
#botaoAdicionarCarrinho { 
  position: fixed; 
  bottom: 20px;
  right: 20px;
  background: #ff6600; 
  color: #fff; 
  font-weight: bold; 
  padding: 10px 18px;
  border-radius: 8px; 
  font-size: 16px;
  cursor: pointer; 
  z-index: 9999; 
  box-shadow: 0 0 12px #ff6600; 
  transition: all 0.3s ease; 
}
#botaoAdicionarCarrinho:hover { transform: scale(1.05); }

/* ================= CARRINHO ================= */
#carrinho {
  background:#111;
  padding:15px;
  position:fixed;
  bottom:0;
  width:100%;
  max-height:300px;
  overflow-y:auto;
  border-top:2px solid #00ff66;
}
#carrinho h3 { margin-top:0; }
#carrinho button {
  background:red;
  color:#fff;
  border:none;
  padding:4px 6px;
  margin-left:5px;
  border-radius:4px;
  cursor:pointer;
}

/* ================= INPUTS ================= */
input, select, textarea {
  width:100%;
  padding:8px;
  margin:6px 0;
  border-radius:6px;
  border:none;
}
textarea { resize:none; }
.finalizar {
  background:#00ff66;
  padding:10px;
  width:100%;
  font-size:18px;
  border-radius:8px;
  margin-top:10px;
  border:none;
  cursor:pointer;
  font-weight:bold;
}

/* ================= PIZZA ================= */
.tamanho-pizza {
  margin:5px 0 10px 0;
  display:flex;
  gap:8px;
}
.tamanho-pizza button {
  flex:1;
  padding:10px 0;
  font-size:16px;
  font-weight:bold;
  border-radius:8px;
  border:2px solid #00ff66;
  background:#111;
  color:#00ff66;
  cursor:pointer;
  transition:all 0.2s ease;
}
.tamanho-pizza button.selected {
  background:#00ff66;
  color:#000;
  box-shadow:0 0 10px #00ff66;
  transform:scale(1.05);
}
</style>
</head>

<body>

<header>
  <img src="logo-kf.png" alt="KF Pizzaria & Tapiocaria"
       onerror="this.style.display='none';document.getElementById('fallback-text').style.display='block'">
  <span id="fallback-text" style="display:none;">KF Pizzaria & Tapiocaria üçïüåÆ</span>
</header>

<nav>
  <button onclick="mostrarMenu('pizzas')">üçï Pizzas</button>
  <button onclick="mostrarMenu('tapiocas')">üåÆ Tapiocas</button>
  <button onclick="mostrarMenu('bebidas')">ü•§ Bebidas</button>
</nav>

<section id="pizzas" class="ativo">
  <div class="tamanho-pizza">
    <button id="t25" onclick="selecionarTamanho('25cm')">25cm</button>
    <button id="t35" onclick="selecionarTamanho('35cm')">35cm</button>
  </div>
  <div id="listaPizzas"></div>
</section>

<section id="tapiocas">
  <h3>Tapiocas (Escolha at√© 2 recheios pagos + 1 Acompanhamento)</h3>
  <div id="listaTapiocas"></div>
</section>

<section id="bebidas">
  <h3>Bebidas</h3>
  <div id="listaBebidas"></div>
</section>

<button id="botaoAdicionarCarrinho"
  onclick="adicionarPizzaAoCarrinho(); adicionarTapiocaAoCarrinho();">
  üõí Adicionar ao Carrinho
</button>

<div id="carrinho">
  <h3>üõí Carrinho</h3>
  <div id="itensCarrinho"></div>
  <p><strong>Total: R$ <span id="totalCarrinho">0.00</span></strong></p>

  <h4>Finalizar Pedido</h4>
  <input id="nome" placeholder="Nome do cliente">
  <input id="endereco" placeholder="Endere√ßo completo">

  <select id="pagamento" onchange="atualizarTrocoPix()">
    <option value="">Forma de pagamento</option>
    <option value="dinheiro">Dinheiro</option>
    <option value="cartao">Cart√£o</option>
    <option value="pix">Pix</option>
  </select>

  <div id="troco-container" style="display:none;">
    <input id="troco" placeholder="Troco para quanto (opcional)">
  </div>

  <textarea id="observacao" placeholder="Observa√ß√µes do pedido (opcional)" rows="2"></textarea>

  <button class="finalizar" onclick="finalizarPedido()">üì≤ Enviar Pedido</button>
</div>

<!-- üî• FIREBASE -->
<script src="firebase.js"></script>

<script>
// ================= DADOS (INALTERADOS) =================
/* TODO: aqui entra exatamente o mesmo JS de dados e fun√ß√µes
   que voc√™ j√° tinha ‚Äî mantido sem altera√ß√µes */
</script>

<script>
// ================= FINALIZAR PEDIDO (FIREBASE) =================
function finalizarPedido(){
  const nome = document.getElementById("nome").value.trim();
  const endereco = document.getElementById("endereco").value.trim();
  const pagamento = document.getElementById("pagamento").value;
  const observacao = document.getElementById("observacao").value.trim();
  const troco = document.getElementById("troco").value.trim();

  if(!nome || !endereco || !pagamento || carrinho.length === 0){
    alert("Preencha todos os dados e adicione itens");
    return;
  }

  let trocoTexto="", pixTexto="";
  if(pagamento==="dinheiro" && troco) trocoTexto = `\nüíµ Troco para: R$ ${troco}`;
  if(pagamento==="pix") pixTexto = "\nüìå Chave Pix: fagpln@gmail.com";

  const enderecoMapa =
    `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(endereco)}`;

  const itensTexto = carrinho
    .map(i => `- ${i.nome} x${i.quantidade} (R$ ${(i.preco*i.quantidade).toFixed(2)})`)
    .join("\n");

  const mensagem =
`üçï *NOVO PEDIDO - KF PIZZARIA*
üë§ *Nome:* ${nome}

üßæ *Pedido:*
${itensTexto}

üìç *Endere√ßo:* ${endereco}
üåê *Mapa:* ${enderecoMapa}

üí≥ *Pagamento:* ${pagamento}${trocoTexto}${pixTexto}
üí∞ *Total:* R$ ${total.toFixed(2)}${observacao ? `\nüìù *Observa√ß√£o:* ${observacao}` : ""}`;

  // WhatsApp
  window.open(
    "https://wa.me/5521997437285?text=" + encodeURIComponent(mensagem),
    "_blank"
  );

  // üî• SALVAR NO FIREBASE (SEM localStorage)
  db.collection("pedidos").add({
    nome,
    endereco,
    pagamento,
    troco: troco || "",
    observacao,
    itens: carrinho,
    total,
    status: "Pendente",
    criadoEm: new Date()
  });

  carrinho = [];
  atualizarCarrinho();
  atualizarBotaoAdicionar();
  alert("Pedido enviado com sucesso!");
}
</script>

</body>
</html>
